<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Primary Meta Tags -->
    <title>Passport Photo Maker - Print Cheap Passport Photos Online Free</title>
    <meta name="title" content="Passport Photo Maker - Print Cheap Passport Photos Online Free">
    <meta name="description" content="Free passport photo maker to print cheap passport photos. Create photo sheets with multiple 2x2 inch passport photos. Save money - print 6-20 photos on one sheet at any photo service worldwide. No signup required.">
    <meta name="keywords" content="passport photo maker, cheap passport photo, passport photo print, photo sheet maker, print passport photos, affordable passport photos, passport photo sheet, ID photo maker, visa photo, 2x2 photo, passport size photo, photo printing tool, bulk photo printing, multiple passport photos, passport photo composite, print photos cheap, CVS passport photo, Walgreens passport photo, Costco photo printing, DIY passport photo, make passport photos at home, passport photo template, passport photo layout, free passport photo tool, passport photo software, photo sheet creator, passport photo grid, ID photo print, passport photo arrange, cheap photo printing, save money passport photos, passport photo cost, budget passport photos, online passport photo, passport photo online free, how to print passport photos, print multiple photos one sheet, passport photo 4x6, passport photo 8x10, photo collage passport, passport photo resize, digital passport photo, print your own passport photos">
    <meta name="author" content="Photo Sheet Maker">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    <meta name="google-site-verification" content="5oz9FT_Li4mZ2d3dGt62HNjMcZd-35MeCmP7gG5xqo4" />
    <link rel="canonical" href="https://aniltv06.github.io/passportphotosheet/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://aniltv06.github.io/passportphotosheet/">
    <meta property="og:title" content="Passport Photo Maker - Print Cheap Passport Photos Online">
    <meta property="og:description" content="Free passport photo maker. Create photo sheets with 6-20 passport photos. Print cheap at any photo service worldwide. Save money - no signup required.">
    <meta property="og:image" content="https://aniltv06.github.io/passportphotosheet/og-image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Photo Sheet Maker">
    <meta property="og:locale" content="en_US">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://aniltv06.github.io/passportphotosheet/">
    <meta name="twitter:title" content="Passport Photo Maker - Print Cheap Passport Photos">
    <meta name="twitter:description" content="Free tool to create passport photo sheets. Print 6-20 photos on one sheet at any photo service worldwide. Save money.">
    <meta name="twitter:image" content="https://aniltv06.github.io/passportphotosheet/twitter-image.jpg">

    <!-- Theme and Mobile -->
    <meta name="theme-color" content="#007AFF">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Photo Sheet">
    <meta name="format-detection" content="telephone=no">

    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="favicon/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
    <link rel="manifest" href="manifest.json">

    <!-- Dynamic Cache Control - Automatically manages cache based on environment -->
    <!-- Development: Disables cache for easier testing -->
    <!-- Production: Enables cache for better performance -->
    <script type="module" src="js/core/meta-loader.js"></script>

    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="preconnect" href="https://www.google-analytics.com">
    <link rel="preconnect" href="https://www.clarity.ms">

    <!-- DNS Prefetch -->
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    <link rel="dns-prefetch" href="https://www.clarity.ms">

    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BHSENQTDSF"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-BHSENQTDSF', {
            'anonymize_ip': true,
            'cookie_flags': 'SameSite=None;Secure'
        });
    </script>

    <!-- Microsoft Clarity -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "u9f5jiwh0y");
    </script>

    <!-- Structured Data (Schema.org JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Passport Photo Maker - Photo Sheet Maker",
      "alternateName": ["Cheap Passport Photo Maker", "Passport Photo Sheet Creator", "DIY Passport Photo Tool"],
      "applicationCategory": "UtilitiesApplication",
      "operatingSystem": "Any",
      "description": "Free passport photo maker to create photo sheets for printing cheap passport photos at any photo printing service worldwide. Arrange multiple 2x2 inch passport photos on standard 4x6, 5x7, or 8x10 inch print sheets. Save money by printing 6-20 photos on one sheet. No signup required.",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "featureList": [
        "Upload passport photos",
        "Create photo sheets with 6-20 photos",
        "Multiple print size options (4x6, 5x7, 8x10)",
        "High-quality 300 DPI output",
        "Cutting guides for easy trimming",
        "Print at any photo service worldwide",
        "Save money on passport photos",
        "Instant download",
        "Multi-language support (12 languages)",
        "Works offline",
        "No watermarks",
        "Free forever"
      ],
      "screenshot": "https://aniltv06.github.io/passportphotosheet/screenshot.jpg",
      "browserRequirements": "Requires JavaScript. Requires HTML5.",
      "softwareVersion": "2.0",
      "author": {
        "@type": "Organization",
        "name": "Photo Sheet Maker"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.9",
        "ratingCount": "2840"
      }
    }
    </script>

    <!-- UX Component Styles -->
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/index-styles.css">
    <link rel="stylesheet" href="css/ux-components.css">
    <link rel="stylesheet" href="css/sticky-scroll.css">
</head>
<body>
    <!-- Skip Link for Screen Readers -->
    <a href="#main-content"
       class="c-skip-link"
       data-testid="skip-link"
       data-action="skip-to-content"
       data-i18n="skipToContent">
        Skip to main content
    </a>

    <!-- ARIA Live Region for Status Announcements -->
    <div id="ariaLiveRegion"
         role="status"
         aria-live="polite"
         aria-atomic="true"
         class="u-visually-hidden visually-hidden"
         data-testid="aria-live-region">
        <!-- Dynamic status messages will be announced here -->
    </div>

    <!-- Keyboard Navigation Hint (Day 8) -->
    <div id="keyboardHint"
         class="c-keyboard-hint"
         role="status"
         aria-live="polite"
         data-testid="keyboard-hint">
        <div class="c-keyboard-hint__text">
            <span class="c-keyboard-hint__icon" aria-hidden="true">‚å®Ô∏è</span>
            <span data-i18n="keyboardHint">Press Tab to navigate, Enter to activate, Escape to cancel</span>
        </div>
    </div>

    <!-- NAVIGATION HEADER -->
    <nav class="c-nav"
         role="navigation"
         aria-label="Main navigation"
         data-testid="main-nav"
         data-component="navigation">
        <div class="c-nav__container l-container">
            <!-- Logo -->
            <a href="index.html"
               class="c-nav__logo"
               aria-label="Home"
               data-testid="nav-logo"
               data-action="navigate-home">
                <div class="c-nav__icon">
                    <div class="c-nav__icon-body">
                        <div class="c-nav__icon-viewfinder"></div>
                        <div class="c-nav__icon-flash"></div>
                        <div class="c-nav__icon-lens">
                            <div class="c-nav__icon-lens-inner">
                                <div class="c-nav__icon-lens-glare"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <span class="c-nav__logo-text">Photo Sheet Maker</span>
            </a>

            <!-- Navigation Links -->
            <div class="c-nav__links">
                <a href="index.html"
                   class="c-nav__link c-nav__link--active"
                   aria-current="page"
                   data-testid="nav-link-home"
                   data-state="active">
                    <span data-i18n="photoMaker">Photo Maker</span>
                </a>
                <a href="photo-editor.html"
                   class="c-nav__link c-nav__link--featured"
                   data-testid="nav-link-editor"
                   data-variant="featured">
                    ‚úÇÔ∏è <span data-i18n="photoEditor">Photo Editor</span>
                </a>
                <a href="public/pages/faq.html"
                   class="c-nav__link"
                   data-testid="nav-link-help">
                    <span data-i18n="help">Help</span>
                </a>
            </div>

            <!-- Language Selector -->
            <select id="languageSelect"
                    class="c-nav__language"
                    aria-label="Select language"
                    data-testid="language-select"
                    data-component="select"
                    data-value="en">
                <option value="en" data-testid="lang-option-en">üá∫üá∏ English</option>
                <option value="es" data-testid="lang-option-es">üá™üá∏ Espa√±ol</option>
                <option value="fr" data-testid="lang-option-fr">üá´üá∑ Fran√ßais</option>
                <option value="de" data-testid="lang-option-de">üá©üá™ Deutsch</option>
                <option value="pt" data-testid="lang-option-pt">üáµüáπ Portugu√™s</option>
                <option value="it" data-testid="lang-option-it">üáÆüáπ Italiano</option>
                <option value="ja" data-testid="lang-option-ja">üáØüáµ Êó•Êú¨Ë™û</option>
                <option value="ko" data-testid="lang-option-ko">üá∞üá∑ ÌïúÍµ≠Ïñ¥</option>
                <option value="zh" data-testid="lang-option-zh">üá®üá≥ ‰∏≠Êñá</option>
                <option value="ar" data-testid="lang-option-ar">üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
                <option value="hi" data-testid="lang-option-hi">üáÆüá≥ ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
                <option value="ru" data-testid="lang-option-ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
            </select>

            <!-- Mobile Menu Toggle -->
            <button class="c-nav__toggle"
                    aria-label="Toggle mobile menu"
                    aria-expanded="false"
                    data-testid="nav-toggle"
                    data-action="toggle-menu"
                    data-state="collapsed">
                ‚ò∞
            </button>
        </div>
    </nav>

    <!-- Container for main content -->
    <div class="l-container" data-testid="main-container" data-layout="container">
        <!-- WORKFLOW SELECTOR -->
        <section class="c-workflow-selector"
                 aria-labelledby="workflow-title"
                 data-testid="workflow-selector"
                 data-component="workflow-selector">
            <h2 id="workflow-title"
                class="c-workflow-selector__title"
                data-i18n="chooseWorkflow"
                data-testid="workflow-title">Choose Your Workflow</h2>

            <div class="c-workflow-selector__options"
                 data-testid="workflow-options">
                <!-- Option 1: Upload Ready Photo -->
                <div class="c-workflow-card c-workflow-card--upload"
                     tabindex="0"
                     aria-label="I have a ready photo"
                     data-testid="workflow-card-upload"
                     data-component="workflow-card"
                     data-variant="upload">
                    <!-- Upload UI will be dynamically generated by photoHandler.js -->
                    <div id="uploadContainer" data-testid="upload-container"></div>
                </div>

                <!-- Option 2: Need to Edit Photo (Featured) -->
                <div class="c-workflow-card c-workflow-card--featured"
                     tabindex="0"
                     role="button"
                     aria-label="I need to edit a photo"
                     data-testid="workflow-card-editor"
                     data-component="workflow-card"
                     data-variant="featured">
                    <div class="c-workflow-card__icon" data-testid="workflow-icon">‚úÇÔ∏è</div>
                    <h3 class="c-workflow-card__title"
                        data-i18n="needToEdit"
                        data-testid="workflow-card-title">I Need to Edit a Photo</h3>
                    <p class="c-workflow-card__description"
                       data-i18n="needToEditDesc"
                       data-testid="workflow-card-description">Crop, resize, or rotate first</p>
                    <a href="photo-editor.html"
                       class="c-button c-button--primary"
                       data-testid="open-editor-button"
                       data-component="button"
                       data-variant="primary"
                       data-action="navigate-editor">
                        <span class="c-button__text" data-i18n="openPhotoEditor">Open Photo Editor</span>
                    </a>
                </div>
            </div>

            <!-- Demo Button Below Workflow Cards -->
            <div style="text-align: center; margin-top: 20px;">
                <button type="button"
                        class="c-button c-button--demo"
                        id="demoBtn"
                        aria-label="Try with demo photo"
                        data-testid="demo-button"
                        data-component="button"
                        data-variant="demo"
                        data-action="load-demo"
                        style="font-size: 14px; padding: 10px 20px;">
                    <span class="c-button__text" data-i18n="tryDemo">üé® Try Demo Photo</span>
                </button>
            </div>
        </section>
    </div>

    <!-- Main Content -->
    <div class="main-content">
    <div class="l-container" data-testid="content-container" data-layout="container">
        <header class="header" role="banner">
            <span class="header-icon" aria-hidden="true">üì∏</span>
            <h1 class="header-title" data-i18n="title">Photo Sheet Maker</h1>
            <p class="header-subtitle" data-i18n="subtitle">Create professional passport photo sheets for printing anywhere in the world</p>
        </header>

        <!-- Feature Cards Section -->
        <section class="l-feature-grid"
                 style="margin-bottom: var(--spacing-4xl);"
                 data-testid="feature-section"
                 data-layout="feature-grid">
            <div class="c-feature-card" data-testid="feature-card-upload" data-variant="upload">
                <div class="c-feature-card__icon" data-testid="feature-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                    </svg>
                </div>
                <h3 class="c-feature-card__title"
                    data-i18n="feature1Title"
                    data-testid="feature-title">Upload Your Photo</h3>
                <p class="c-feature-card__description"
                   data-i18n="feature1Desc"
                   data-testid="feature-description">Simply upload your 2√ó2 inch passport photo. Works with JPG and PNG formats.</p>
            </div>
            <div class="c-feature-card" data-testid="feature-card-customize" data-variant="customize">
                <div class="c-feature-card__icon" data-testid="feature-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1V5zm10 0a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1V5zM4 15a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1v-4zm10 0a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z" />
                    </svg>
                </div>
                <h3 class="c-feature-card__title"
                    data-i18n="feature2Title"
                    data-testid="feature-title">Customize Layout</h3>
                <p class="c-feature-card__description"
                   data-i18n="feature2Desc"
                   data-testid="feature-description">Choose from 4√ó6, 5√ó7, or 8√ó10 inch sheets. Fit up to 20 photos on one sheet.</p>
            </div>
            <div class="c-feature-card" data-testid="feature-card-download" data-variant="download">
                <div class="c-feature-card__icon" data-testid="feature-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                    </svg>
                </div>
                <h3 class="c-feature-card__title"
                    data-i18n="feature3Title"
                    data-testid="feature-title">Download & Print</h3>
                <p class="c-feature-card__description"
                   data-i18n="feature3Desc"
                   data-testid="feature-description">Download high-quality 300 DPI images. Print at any photo service worldwide.</p>
            </div>
        </section>

        <main id="main-content" role="main">
            <div class="c-card"
                 data-testid="main-content-card"
                 data-component="card">
                <div class="c-info-banner"
                     role="complementary"
                     aria-label="Quick start guide"
                     data-testid="info-banner"
                     data-component="info-banner">
                    <h2 class="c-info-banner__title"
                        data-testid="info-banner-title">
                        <span aria-hidden="true">üí°</span>
                        <span data-i18n="benefitsTitle">Why Use Photo Sheet Maker?</span>
                    </h2>
                    <ul class="c-info-banner__list"
                        data-testid="info-banner-list">
                        <li data-i18n="benefit1"
                            data-testid="info-banner-item">Upload your 2√ó2 inch (51√ó51mm) passport or ID photo</li>
                        <li data-i18n="benefit2"
                            data-testid="info-banner-item">Arrange multiple copies on one standard print sheet</li>
                        <li data-i18n="benefit3"
                            data-testid="info-banner-item">Download and print at any photo printing service worldwide</li>
                        <li data-i18n="benefit4"
                            data-testid="info-banner-item">Save money - print up to 20 photos on a single sheet!</li>
                        <li data-i18n="benefit5"
                            data-testid="info-banner-item">100% free, no watermarks, no signup required</li>
                    </ul>
                    <p class="c-info-banner__disclaimer"
                       style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(0,122,255,0.2); font-size: 13px; color: #666; line-height: 1.5;"
                       data-testid="info-banner-disclaimer">
                        <strong>‚ö†Ô∏è Important Disclaimer:</strong> This tool arranges photos on a sheet for printing. You are responsible for ensuring your original photo meets official passport/ID requirements. We do not guarantee acceptance by any authority. Use at your own discretion. See <a href="public/pages/terms-of-service.html" style="color: #007AFF;">Terms of Service</a>.
                    </p>
                </div>

                <!-- PROGRESS INDICATORS -->
                <div class="progress-steps" id="progressSteps" style="display: none;">
                    <div class="step completed" data-step="1">
                        <div class="step-number">1</div>
                        <div class="step-label" data-i18n="stepUpload">Upload</div>
                    </div>

                    <div class="step-connector"></div>

                    <div class="step active" data-step="2">
                        <div class="step-number">2</div>
                        <div class="step-label" data-i18n="stepCustomize">Customize</div>
                    </div>

                    <div class="step-connector"></div>

                    <div class="step" data-step="3">
                        <div class="step-number">3</div>
                        <div class="step-label" data-i18n="stepDownload">Download</div>
                    </div>
                </div>

                <section class="preview-section" id="previewSection" aria-label="Preview and download your photo sheet">
                    <div class="l-customize-preview"
                         data-testid="customize-preview-layout"
                         data-layout="customize-preview">
                        <!-- Left Side: Customization Options -->
                        <div class="customize-panel">
                            <h2 class="section-title">
                                <span aria-hidden="true">‚öôÔ∏è</span>
                                <span data-i18n="customizeTitle">Customize Your Sheet</span>
                            </h2>

                            <form class="c-form c-form--stack"
                                  id="optionsForm"
                                  data-testid="customization-form"
                                  data-component="form"
                                  data-variant="stack">
                                <div class="c-form__group" data-testid="form-group-size">
                                    <label for="paperSize"
                                           class="c-form__label"
                                           data-i18n="sheetSizeLabel"
                                           data-testid="form-label-size">Sheet Size</label>
                                    <select id="paperSize"
                                            class="c-form__select"
                                            aria-label="Select print sheet size"
                                            data-testid="form-select-size"
                                            data-component="select"
                                            data-field="paperSize">
                                        <option value="4x6-2" data-i18n="size4x6_2" data-testid="size-option-4x6-2">üé´ 4√ó6" Print (2 photos)</option>
                                        <option value="4x6-4" data-i18n="size4x6_4" data-testid="size-option-4x6-4">üé¥ 4√ó6" Print (4 photos)</option>
                                        <option value="4x6" selected data-i18n="size4x6" data-testid="size-option-4x6">üí∞ 4√ó6" Print (6 photos)</option>
                                        <option value="5x7" data-i18n="size5x7" data-testid="size-option-5x7">üíµ 5√ó7" Print (6 photos)</option>
                                        <option value="8x10" data-i18n="size8x10" data-testid="size-option-8x10">üíé 8√ó10" Print (20 photos) ‚≠ê Best Value</option>
                                    </select>
                                    <div class="c-form__hint"
                                         data-i18n="sheetSizeHint"
                                         data-testid="form-hint-size">Choose the print size you want to order</div>
                                </div>

                                <div class="c-form__group" data-testid="form-group-quality">
                                    <label for="quality"
                                           class="c-form__label"
                                           data-i18n="qualityLabel"
                                           data-testid="form-label-quality">Photo Quality</label>
                                    <select id="quality"
                                            class="c-form__select"
                                            aria-label="Select photo print quality"
                                            data-testid="form-select-quality"
                                            data-component="select"
                                            data-field="quality">
                                        <option value="high" data-i18n="qualityHigh" data-testid="quality-option-high">Professional (300 DPI) ‚≠ê Recommended</option>
                                        <option value="medium" data-i18n="qualityMedium" data-testid="quality-option-medium">Standard (200 DPI)</option>
                                    </select>
                                    <div class="c-form__hint"
                                         data-i18n="qualityHint"
                                         data-testid="form-hint-quality">Higher quality for clearer photos</div>
                                </div>

                                <div class="c-form__group" data-testid="form-group-cutting">
                                    <label for="cuttingGuide"
                                           class="c-form__label"
                                           data-i18n="cuttingGuideLabel"
                                           data-testid="form-label-cutting">Cutting Guide</label>
                                    <select id="cuttingGuide"
                                            class="c-form__select"
                                            aria-label="Select cutting guide option"
                                            data-testid="form-select-cutting"
                                            data-component="select"
                                            data-field="cuttingGuide">
                                        <option value="none-none" selected data-i18n="guideNoGuides" data-testid="cutting-option-none">No Guides (Maximum Photos) ‚≠ê</option>
                                        <option value="small-none" data-i18n="guideCuttingLines" data-testid="cutting-option-lines">Cutting Lines Between Photos</option>
                                        <option value="none-thin" data-i18n="guideBorderGuide" data-testid="cutting-option-border">Border Guide Inside Photos</option>
                                        <option value="small-thin" data-i18n="guideFullGuidance" data-testid="cutting-option-full">Full Guidance (Lines + Border)</option>
                                    </select>
                                    <div class="c-form__hint"
                                         id="cuttingGuideHint"
                                         data-testid="form-hint-cutting">
                                        <span data-i18n="cuttingGuideHint">Choose how you want to cut your photos</span>
                                        <span id="cuttingGuideDisabledHint"
                                              style="display: none; color: var(--warning-color);"
                                              data-i18n="cuttingGuideDisabledHint"
                                              data-testid="cutting-disabled-hint">Not available for this sheet size</span>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- Right Side: Preview -->
                        <div class="preview-panel">
                            <h2 class="section-title">
                                <span aria-hidden="true">üëÅÔ∏è</span>
                                <span data-i18n="previewTitle">Your Photo Sheet</span>
                            </h2>

                            <div class="canvas-wrapper">
                                <div class="canvas-label" data-i18n="canvasLabel">Preview of your photo sheet</div>
                                <div class="canvas-container">
                                    <canvas id="canvas" role="img" aria-label="Preview of your photo sheet layout"></canvas>
                                </div>
                            </div>

                            <div class="l-stat-grid"
                                 data-testid="stats-grid"
                                 data-layout="stat-grid">
                                <div class="c-stat-card" data-testid="stat-card-count" data-variant="count">
                                    <span class="c-stat-card__value"
                                          id="photoCount"
                                          data-testid="photo-count">20</span>
                                    <span class="c-stat-card__label"
                                          data-i18n="statPhotos"
                                          data-testid="stat-label">Photos Included</span>
                                </div>
                                <div class="c-stat-card" data-testid="stat-card-size" data-variant="size">
                                    <span class="c-stat-card__value"
                                          id="sheetSize"
                                          data-testid="sheet-size">8√ó10"</span>
                                    <span class="c-stat-card__label"
                                          data-i18n="statSize"
                                          data-testid="stat-label">Print Size</span>
                                </div>
                            </div>

                            <div class="l-button-group">
                                <button type="button"
                                        class="c-button c-button--primary"
                                        id="downloadBtn"
                                        aria-label="Download your photo sheet"
                                        data-testid="download-button"
                                        data-component="button"
                                        data-variant="primary"
                                        data-action="download">
                                    <span class="c-button__icon" aria-hidden="true">‚¨áÔ∏è</span>
                                    <span class="c-button__text" data-i18n="downloadBtn">Download Photo Sheet</span>
                                </button>
                                <button type="button"
                                        class="c-button c-button--secondary"
                                        id="resetBtn"
                                        aria-label="Start over with a new photo"
                                        data-testid="reset-button"
                                        data-component="button"
                                        data-variant="secondary"
                                        data-action="reset">
                                    <span class="c-button__icon" aria-hidden="true">‚Üª</span>
                                    <span class="c-button__text" data-i18n="resetBtn">Start Over</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <aside class="instructions" role="complementary">
                <h2 class="instructions-title">
                    <span aria-hidden="true">üìã</span>
                    <span data-i18n="instructionsTitle">How to Print Your Photos</span>
                </h2>
                <ol class="instructions-list">
                    <li data-i18n="instruction1">Click "Download Photo Sheet" above to save your file</li>
                    <li data-i18n="instruction2">Visit your local photo printing service or online print shop</li>
                    <li data-i18n="instruction3">Select "Print Photos" and upload your downloaded file</li>
                    <li data-i18n="instruction4">Choose the same size you selected above (4√ó6", 5√ó7", or 8√ó10")</li>
                    <li data-i18n="instruction5">Select "Matte Finish" for best results with passport photos</li>
                    <li data-i18n="instruction6">Order pickup or delivery based on your preference</li>
                    <li data-i18n="instruction7">Cut carefully along the edges using scissors or a paper cutter</li>
                </ol>
            </aside>
        </main>
    </div>
    </div>
    <!-- End Main Content -->

        <!-- Footer Container - Loaded from components/footer.html -->
        <div id="footer-container"></div>
    </div>

    <!-- HEIC to JPEG/PNG Converter Library -->
    <script src="https://cdn.jsdelivr.net/npm/heic2any@0.0.4/dist/heic2any.min.js"></script>

    <!-- Load translations from modular structure -->
    <script type="module" src="translations/index.js"></script>

    <script type="module">
        'use strict';

        // Wait for translations to be loaded
        function waitForTranslations(callback) {
            if (window.translations && typeof window.translations === 'object') {
                callback();
            } else {
                // Check again in 50ms
                setTimeout(() => waitForTranslations(callback), 50);
            }
        }

        // i18n functionality
        let currentLanguage = localStorage.getItem('preferredLanguage') || 'en';

        window.translatePage = function(lang) {
            const elements = document.querySelectorAll('[data-i18n]');
            elements.forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (window.translations[lang] && window.translations[lang][key]) {
                    el.textContent = window.translations[lang][key];
                }
            });
            document.documentElement.lang = lang;
            localStorage.setItem('preferredLanguage', lang);
            currentLanguage = lang;
        };

        // Initialize translations when ready
        function initTranslations() {
            waitForTranslations(() => {
                const languageSelect = document.getElementById('languageSelect');
                if (languageSelect) {
                    languageSelect.value = currentLanguage;
                    languageSelect.addEventListener('change', (e) => {
                        currentLanguage = e.target.value;
                        window.translatePage(currentLanguage);
                        if (typeof window.trackEvent === 'function') {
                            window.trackEvent('language_changed', { language: currentLanguage });
                        }
                    });
                }

                // Apply initial translation
                window.translatePage(currentLanguage);
            });
        }

        // Initialize on DOMContentLoaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initTranslations);
        } else {
            initTranslations();
        }
    </script>

    <script>
        'use strict';

        // Analytics Helper Functions
        window.trackEvent = function(eventName, eventParams = {}) {
            // Google Analytics 4
            if (typeof gtag === 'function') {
                gtag('event', eventName, eventParams);
            }

            // Microsoft Clarity Custom Tags
            if (typeof clarity === 'function') {
                clarity('set', eventName, JSON.stringify(eventParams));
            }
        }

        function trackPageView() {
            if (typeof gtag === 'function') {
                gtag('event', 'page_view', {
                    page_title: document.title,
                    page_location: window.location.href,
                    page_path: window.location.pathname
                });
            }
        }

        // DOM Elements
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const paperSize = document.getElementById('paperSize');
        const quality = document.getElementById('quality');
        const cuttingGuide = document.getElementById('cuttingGuide');
        const previewSection = document.getElementById('previewSection');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d', { alpha: false });
        const downloadBtn = document.getElementById('downloadBtn');
        const resetBtn = document.getElementById('resetBtn');
        const demoBtn = document.getElementById('demoBtn');
        const photoCount = document.getElementById('photoCount');
        const sheetSize = document.getElementById('sheetSize');

        // State
        let uploadedImage = null;

        // Configuration
        const LAYOUTS = {
            '4x6-2': { width: 4, height: 6, cols: 1, rows: 2, photos: 2, icon: 'üé´', customSpacing: true, spacingType: 'vertical-apart' },
            '4x6-4': { width: 4, height: 6, cols: 2, rows: 2, photos: 4, icon: 'üé¥', customSpacing: true, spacingType: 'vertical-centered' },
            '4x6': { width: 4, height: 6, cols: 2, rows: 3, photos: 6, icon: 'üí∞' },
            '5x7': { width: 5, height: 7, cols: 2, rows: 3, photos: 6, icon: 'üíµ', customSpacing: true, spacingType: 'grid-aligned' },
            '8x10': { width: 8, height: 10, cols: 4, rows: 5, photos: 20, icon: 'üíé' }
        };

        const PHOTO_SIZE_INCHES = 2;

        // Utility Functions
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function showError(message) {
            alert(message);
            console.error(message);
        }

        function announceToScreenReader(message) {
            // Use dedicated ARIA live region for announcements
            const liveRegion = document.getElementById('ariaLiveRegion');
            if (liveRegion) {
                // Clear previous message
                liveRegion.textContent = '';

                // Add new message after a brief delay to ensure it's announced
                setTimeout(() => {
                    liveRegion.textContent = message;
                }, 100);

                // Clear message after 3 seconds to prevent clutter
                setTimeout(() => {
                    liveRegion.textContent = '';
                }, 3000);
            }
        }

        function validateImageFile(file) {
            // Basic check to ensure it's an image file
            if (!file.type.startsWith('image/')) {
                throw new Error(window.translations[currentLanguage]?.errorImageUpload || 'Please upload an image file.');
            }

            return true;
        }

        // ======================================
        // Enhanced Focus Management (Day 8)
        // ======================================

        /**
         * Move focus to an element and announce it to screen readers
         * @param {string} selector - CSS selector for the target element
         * @param {string} announcement - Message to announce to screen readers
         */
        function manageFocus(selector, announcement) {
            const element = document.querySelector(selector);
            if (element) {
                // Make element focusable if it isn't already
                if (!element.hasAttribute('tabindex')) {
                    element.setAttribute('tabindex', '-1');
                }

                // Focus the element
                element.focus();

                // Announce to screen readers
                if (announcement) {
                    announceToScreenReader(announcement);
                }

                // Remove temporary tabindex after focus
                if (element.getAttribute('tabindex') === '-1') {
                    element.addEventListener('blur', function removeTabindex() {
                        element.removeAttribute('tabindex');
                        element.removeEventListener('blur', removeTabindex);
                    }, { once: true });
                }
            }
        }

        /**
         * Trap focus within a container for modal-like interactions
         * @param {HTMLElement} container - Container element to trap focus within
         * @returns {Function} - Cleanup function to remove focus trap
         */
        function trapFocus(container) {
            const focusableElements = container.querySelectorAll(
                'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
            );
            const firstFocusable = focusableElements[0];
            const lastFocusable = focusableElements[focusableElements.length - 1];

            function handleTabKey(e) {
                if (e.key === 'Tab') {
                    if (e.shiftKey) {
                        // Shift + Tab
                        if (document.activeElement === firstFocusable) {
                            e.preventDefault();
                            lastFocusable.focus();
                        }
                    } else {
                        // Tab
                        if (document.activeElement === lastFocusable) {
                            e.preventDefault();
                            firstFocusable.focus();
                        }
                    }
                }
            }

            container.addEventListener('keydown', handleTabKey);

            // Return cleanup function
            return () => {
                container.removeEventListener('keydown', handleTabKey);
            };
        }

        // ======================================
        // Photo Upload - Now handled by photoHandler module
        // See: js/photoHandler.js and js/photoHandler-index.js
        // Integration script at bottom of file
        // ======================================

        // Event Listeners - Options
        const handleOptionsChange = debounce(() => {
            if (uploadedImage) {
                createComposite();
                announceToScreenReader(window.translations[currentLanguage]?.srPhotoSheetUpdated || 'Photo sheet updated with new settings.');

                // Track option changes
                const [spacing, border] = cuttingGuide.value.split('-');
                trackEvent('options_changed', {
                    paper_size: paperSize.value,
                    quality: quality.value,
                    cutting_guide: cuttingGuide.value,
                    spacing: spacing,
                    border: border
                });
            }
        }, 100);

        // Update cutting guide availability based on paper size
        function updateCuttingGuideAvailability() {
            const size = paperSize.value;
            const cuttingGuideDisabledHint = document.getElementById('cuttingGuideDisabledHint');
            const currentValue = cuttingGuide.value;
            const [currentSpacing, currentBorder] = currentValue.split('-');

            // Only 5x7 has margins for cutting lines
            // 4x6 and 8x10 are edge-to-edge and photos would be scaled down
            const disableCuttingLines = (size === '4x6' || size === '8x10');

            // Get all options
            const options = cuttingGuide.querySelectorAll('option');
            let shouldResetValue = false;

            options.forEach(option => {
                const [spacing, border] = option.value.split('-');

                // Disable options that have cutting lines (spacing='small') for 4x6 and 8x10
                if (spacing === 'small' && disableCuttingLines) {
                    option.disabled = true;
                    option.style.color = '#999';

                    // If current selection is being disabled, we need to reset
                    if (option.value === currentValue) {
                        shouldResetValue = true;
                    }
                } else {
                    option.disabled = false;
                    option.style.color = '';
                }
            });

            // Reset to "none-none" if current selection was disabled
            if (shouldResetValue) {
                cuttingGuide.value = 'none-none';
            }

            // Show/hide disabled hint
            if (disableCuttingLines && currentSpacing === 'small') {
                cuttingGuideDisabledHint.style.display = 'block';
            } else {
                cuttingGuideDisabledHint.style.display = 'none';
            }
        }

        paperSize.addEventListener('change', () => {
            updateCuttingGuideAvailability();
            handleOptionsChange();
        });
        quality.addEventListener('change', handleOptionsChange);
        cuttingGuide.addEventListener('change', handleOptionsChange);

        // Initialize cutting guide availability
        updateCuttingGuideAvailability();

        // Background Grid Drawing Function (for cutting guidance)
        function drawBackgroundGrid(canvasWidth, canvasHeight, dpi) {
            const marginSize = 0.25 * dpi; // 0.25 inch margin for measurements
            const gridInterval = 0.25 * dpi; // 0.25 inch grid (quarter inch)

            // Save context state
            ctx.save();

            // Draw very thin light gray grid lines in background
            ctx.strokeStyle = '#E0E0E0';
            ctx.lineWidth = 0.5;
            ctx.globalAlpha = 0.5;

            // Vertical grid lines
            for (let x = 0; x <= canvasWidth; x += gridInterval) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvasHeight);
                ctx.stroke();
            }

            // Horizontal grid lines
            for (let y = 0; y <= canvasHeight; y += gridInterval) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvasWidth, y);
                ctx.stroke();
            }

            // Reset alpha for measurement scales
            ctx.globalAlpha = 1.0;

            // Draw measurement scales on margins
            ctx.fillStyle = '#666666';
            ctx.strokeStyle = '#666666';
            ctx.lineWidth = 1;
            ctx.font = '10px -apple-system, BlinkMacSystemFont, sans-serif';
            ctx.textAlign = 'center';

            // Top scale (horizontal measurements)
            for (let x = 0; x <= canvasWidth; x += dpi) { // Every inch
                const inches = x / dpi;

                // Draw tick mark
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, marginSize * 0.5);
                ctx.stroke();

                // Draw label
                ctx.fillText(`${inches}"`, x, marginSize * 0.8);
            }

            // Left scale (vertical measurements)
            ctx.textAlign = 'right';
            for (let y = 0; y <= canvasHeight; y += dpi) { // Every inch
                const inches = y / dpi;

                // Draw tick mark
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(marginSize * 0.5, y);
                ctx.stroke();

                // Draw label
                ctx.save();
                ctx.translate(marginSize * 0.9, y);
                ctx.rotate(-Math.PI / 2);
                ctx.fillText(`${inches}"`, 0, 0);
                ctx.restore();
            }

            // Right scale (vertical measurements)
            ctx.textAlign = 'left';
            for (let y = 0; y <= canvasHeight; y += dpi) { // Every inch
                const inches = y / dpi;

                // Draw tick mark
                ctx.beginPath();
                ctx.moveTo(canvasWidth, y);
                ctx.lineTo(canvasWidth - marginSize * 0.5, y);
                ctx.stroke();

                // Draw label
                ctx.save();
                ctx.translate(canvasWidth - marginSize * 0.9, y);
                ctx.rotate(-Math.PI / 2);
                ctx.fillText(`${inches}"`, 0, 0);
                ctx.restore();
            }

            // Bottom scale (horizontal measurements)
            ctx.textAlign = 'center';
            for (let x = 0; x <= canvasWidth; x += dpi) { // Every inch
                const inches = x / dpi;

                // Draw tick mark
                ctx.beginPath();
                ctx.moveTo(x, canvasHeight);
                ctx.lineTo(x, canvasHeight - marginSize * 0.5);
                ctx.stroke();

                // Draw label
                ctx.fillText(`${inches}"`, x, canvasHeight - marginSize * 0.2);
            }

            // Draw quarter-inch tick marks (smaller)
            ctx.lineWidth = 0.5;
            ctx.globalAlpha = 0.7;

            // Top quarter-inch ticks
            for (let x = 0; x <= canvasWidth; x += gridInterval) {
                if (x % dpi !== 0) { // Skip full inch marks
                    ctx.beginPath();
                    ctx.moveTo(x, 0);
                    ctx.lineTo(x, marginSize * 0.3);
                    ctx.stroke();
                }
            }

            // Bottom quarter-inch ticks
            for (let x = 0; x <= canvasWidth; x += gridInterval) {
                if (x % dpi !== 0) { // Skip full inch marks
                    ctx.beginPath();
                    ctx.moveTo(x, canvasHeight);
                    ctx.lineTo(x, canvasHeight - marginSize * 0.3);
                    ctx.stroke();
                }
            }

            // Left quarter-inch ticks
            for (let y = 0; y <= canvasHeight; y += gridInterval) {
                if (y % dpi !== 0) { // Skip full inch marks
                    ctx.beginPath();
                    ctx.moveTo(0, y);
                    ctx.lineTo(marginSize * 0.3, y);
                    ctx.stroke();
                }
            }

            // Right quarter-inch ticks
            for (let y = 0; y <= canvasHeight; y += gridInterval) {
                if (y % dpi !== 0) { // Skip full inch marks
                    ctx.beginPath();
                    ctx.moveTo(canvasWidth, y);
                    ctx.lineTo(canvasWidth - marginSize * 0.3, y);
                    ctx.stroke();
                }
            }

            // Restore context state
            ctx.restore();
        }

        // Create Composite Function
        function createComposite() {
            const size = paperSize.value;
            const layout = LAYOUTS[size];
            const dpi = quality.value === 'high' ? 300 : 200;

            // Parse cutting guide value (format: "spacing-border")
            const [spacing, border] = cuttingGuide.value.split('-');
            const gapEnabled = spacing === 'small';
            const gapSize = gapEnabled ? 0.05 : 0; // 0.05 inches gap
            const borderEnabled = border === 'thin';

            // Update stats
            photoCount.textContent = layout.photos;
            sheetSize.textContent = size.replace('x', '√ó') + '"';

            // Calculate dimensions
            const canvasWidth = layout.width * dpi;
            const canvasHeight = layout.height * dpi;
            const photoSizePx = PHOTO_SIZE_INCHES * dpi;
            const gapSizePx = gapSize * dpi;

            // Set canvas size
            canvas.width = canvasWidth;
            canvas.height = canvasHeight;

            // Fill background
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, canvasWidth, canvasHeight);

            // Enable image smoothing for better quality
            ctx.imageSmoothingEnabled = true;
            ctx.imageSmoothingQuality = 'high';

            // Handle custom spacing layouts
            if (layout.customSpacing) {
                if (layout.spacingType === 'vertical-apart') {
                    // 4x6" with 2 photos - aligned to grid at 0.5" intervals
                    // Layout: 0.5" top, photo (2"), 1.0" gap, photo (2"), 0.5" bottom = 6"
                    const topMargin = 0.5 * dpi; // 0.5" top (aligns to grid)
                    const middleGap = 1.0 * dpi;  // 1.0" between photos (aligns to grid)
                    const x = (canvasWidth - photoSizePx) / 2; // Center horizontally

                    // Draw background grid and measurement scales for cutting guidance
                    drawBackgroundGrid(canvasWidth, canvasHeight, dpi);

                    // Reset context properties for photo drawing
                    ctx.globalAlpha = 1.0;
                    ctx.globalCompositeOperation = 'source-over';
                    ctx.imageSmoothingEnabled = true;
                    ctx.imageSmoothingQuality = 'high';

                    for (let row = 0; row < layout.rows; row++) {
                        // Photo 1 at 0.5", Photo 2 at 3.5" (0.5" + 2" + 1.0")
                        const y = topMargin + (row * (photoSizePx + middleGap));
                        ctx.drawImage(uploadedImage, x, y, photoSizePx, photoSizePx);

                        if (gapEnabled) {
                            ctx.strokeStyle = '#CCCCCC';
                            ctx.lineWidth = 1;
                            ctx.strokeRect(x, y, photoSizePx, photoSizePx);
                        }

                        if (borderEnabled) {
                            ctx.strokeStyle = '#CCCCCC';
                            ctx.lineWidth = Math.max(0.5, dpi / 150);
                            const borderOffset = ctx.lineWidth / 2;
                            ctx.strokeRect(
                                x + borderOffset,
                                y + borderOffset,
                                photoSizePx - ctx.lineWidth,
                                photoSizePx - ctx.lineWidth
                            );
                        }
                    }
                } else if (layout.spacingType === 'vertical-centered') {
                    // 4x6" with 4 photos - leave gaps at top and bottom, center the 2x2 grid
                    const totalPhotosWidth = (layout.cols * photoSizePx) + gapSizePx;
                    const totalPhotosHeight = (layout.rows * photoSizePx) + gapSizePx;
                    const startX = (canvasWidth - totalPhotosWidth) / 2;
                    const startY = (canvasHeight - totalPhotosHeight) / 2;

                    for (let row = 0; row < layout.rows; row++) {
                        for (let col = 0; col < layout.cols; col++) {
                            const x = startX + (col * (photoSizePx + gapSizePx));
                            const y = startY + (row * (photoSizePx + gapSizePx));

                            ctx.drawImage(uploadedImage, x, y, photoSizePx, photoSizePx);

                            if (gapEnabled) {
                                ctx.strokeStyle = '#CCCCCC';
                                ctx.lineWidth = 1;
                                ctx.strokeRect(x, y, photoSizePx, photoSizePx);
                            }

                            if (borderEnabled) {
                                ctx.strokeStyle = '#CCCCCC';
                                ctx.lineWidth = Math.max(0.5, dpi / 150);
                                const borderOffset = ctx.lineWidth / 2;
                                ctx.strokeRect(
                                    x + borderOffset,
                                    y + borderOffset,
                                    photoSizePx - ctx.lineWidth,
                                    photoSizePx - ctx.lineWidth
                                );
                            }
                        }
                    }
                } else if (layout.spacingType === 'grid-aligned') {
                    // 5x7" with 6 photos - aligned to 0.25" grid intervals
                    // Layout: 0.25" left, 0.5" gap between columns, 0.25" right
                    //         0.25" top, 0.25" gaps between rows, 0.25" bottom
                    const leftMargin = 0.25 * dpi;   // 0.25" left margin
                    const topMargin = 0.25 * dpi;    // 0.25" top margin
                    const colGap = 0.5 * dpi;        // 0.5" gap between columns
                    const rowGap = 0.25 * dpi;       // 0.25" gap between rows

                    // Draw background grid and measurement scales for cutting guidance
                    drawBackgroundGrid(canvasWidth, canvasHeight, dpi);

                    // Reset context properties for photo drawing
                    ctx.globalAlpha = 1.0;
                    ctx.globalCompositeOperation = 'source-over';
                    ctx.imageSmoothingEnabled = true;
                    ctx.imageSmoothingQuality = 'high';

                    for (let row = 0; row < layout.rows; row++) {
                        for (let col = 0; col < layout.cols; col++) {
                            const x = leftMargin + (col * (photoSizePx + colGap)); // 0.5" gap between photos
                            const y = topMargin + (row * (photoSizePx + rowGap));  // 0.25" gaps between rows

                            ctx.drawImage(uploadedImage, x, y, photoSizePx, photoSizePx);

                            if (gapEnabled) {
                                ctx.strokeStyle = '#CCCCCC';
                                ctx.lineWidth = 1;
                                ctx.strokeRect(x, y, photoSizePx, photoSizePx);
                            }

                            if (borderEnabled) {
                                ctx.strokeStyle = '#CCCCCC';
                                ctx.lineWidth = Math.max(0.5, dpi / 150);
                                const borderOffset = ctx.lineWidth / 2;
                                ctx.strokeRect(
                                    x + borderOffset,
                                    y + borderOffset,
                                    photoSizePx - ctx.lineWidth,
                                    photoSizePx - ctx.lineWidth
                                );
                            }
                        }
                    }
                }
            } else {
                // Standard grid positioning
                const totalPhotosWidth = (layout.cols * photoSizePx) + ((layout.cols - 1) * gapSizePx);
                const totalPhotosHeight = (layout.rows * photoSizePx) + ((layout.rows - 1) * gapSizePx);
                const startX = (canvasWidth - totalPhotosWidth) / 2;
                const startY = (canvasHeight - totalPhotosHeight) / 2;

                // Draw photos in grid
                for (let row = 0; row < layout.rows; row++) {
                    for (let col = 0; col < layout.cols; col++) {
                        const x = startX + (col * (photoSizePx + gapSizePx));
                        const y = startY + (row * (photoSizePx + gapSizePx));

                        // Draw the image
                        ctx.drawImage(uploadedImage, x, y, photoSizePx, photoSizePx);

                        // Draw cutting guides if spacing is enabled
                        if (gapEnabled) {
                            ctx.strokeStyle = '#CCCCCC';
                            ctx.lineWidth = 1;
                            ctx.strokeRect(x, y, photoSizePx, photoSizePx);
                        }

                        // Draw thin border inside photo if enabled
                        if (borderEnabled) {
                            ctx.strokeStyle = '#CCCCCC';
                            ctx.lineWidth = Math.max(0.5, dpi / 150);
                            const borderOffset = ctx.lineWidth / 2;
                            ctx.strokeRect(
                                x + borderOffset,
                                y + borderOffset,
                                photoSizePx - ctx.lineWidth,
                                photoSizePx - ctx.lineWidth
                            );
                        }
                    }
                }
            }
        }

        // Download Handler
        downloadBtn.addEventListener('click', () => {
            try {
                const link = document.createElement('a');
                const size = paperSize.value;
                const timestamp = new Date().toISOString().slice(0, 10);
                link.download = `photo-sheet-${size}-${timestamp}.jpg`;
                link.href = canvas.toDataURL('image/jpeg', 0.95);
                link.click();

                announceToScreenReader(window.translations[currentLanguage]?.srDownloadSuccess || 'Your photo sheet has been downloaded successfully.');

                // Track download event
                const [spacing, border] = cuttingGuide.value.split('-');
                trackEvent('photo_sheet_downloaded', {
                    paper_size: size,
                    quality: quality.value,
                    cutting_guide: cuttingGuide.value,
                    has_cutting_guides: spacing !== 'none' || border !== 'none',
                    photo_count: LAYOUTS[size].photos,
                    language: currentLanguage
                });
            } catch (error) {
                showError(window.translations[currentLanguage]?.errorDownloadFailed || 'Could not download the file. Please try again.');
                trackEvent('download_error', { error: error.message });
                console.error(error);
            }
        });

        // Reset Handler - Now handled by photoHandler module
        // See integration script at bottom of file
        // The handler will be connected there to use handleStartOver()

        // Demo Button Handler
        demoBtn.addEventListener('click', () => {
            // Create a canvas to draw the demo photo
            const demoCanvas = document.createElement('canvas');
            demoCanvas.width = 600;
            demoCanvas.height = 600;
            const demoCtx = demoCanvas.getContext('2d');

            // Background
            const gradient = demoCtx.createLinearGradient(0, 0, 600, 600);
            gradient.addColorStop(0, '#e8f4f8');
            gradient.addColorStop(1, '#d4e8f0');
            demoCtx.fillStyle = gradient;
            demoCtx.fillRect(0, 0, 600, 600);

            // Passport photo standards: head centered with proper framing
            // Head (reduced size with more top gap)
            demoCtx.fillStyle = '#ffd4a3';
            demoCtx.beginPath();
            demoCtx.ellipse(300, 350, 130, 135, 0, 0, Math.PI * 2);
            demoCtx.fill();

            // Ears - visible and realistic
            demoCtx.fillStyle = '#f5c897';
            // Left ear
            demoCtx.beginPath();
            demoCtx.ellipse(175, 330, 18, 35, -0.15, 0, Math.PI * 2);
            demoCtx.fill();
            // Left ear inner detail
            demoCtx.fillStyle = '#e8b885';
            demoCtx.beginPath();
            demoCtx.ellipse(180, 330, 8, 20, -0.15, 0, Math.PI * 2);
            demoCtx.fill();

            // Right ear
            demoCtx.fillStyle = '#f5c897';
            demoCtx.beginPath();
            demoCtx.ellipse(425, 330, 18, 35, 0.15, 0, Math.PI * 2);
            demoCtx.fill();
            // Right ear inner detail
            demoCtx.fillStyle = '#e8b885';
            demoCtx.beginPath();
            demoCtx.ellipse(420, 330, 8, 20, 0.15, 0, Math.PI * 2);
            demoCtx.fill();

            // Hair - fuller, more natural coverage
            demoCtx.fillStyle = '#4a3428';

            // Main hair mass - covers most of top head
            demoCtx.beginPath();
            demoCtx.ellipse(300, 200, 155, 135, 0, 0, Math.PI * 2);
            demoCtx.fill();

            // Hair sides - fuller coverage near face
            demoCtx.beginPath();
            demoCtx.ellipse(200, 280, 45, 75, -0.15, 0, Math.PI * 2);
            demoCtx.fill();
            demoCtx.beginPath();
            demoCtx.ellipse(400, 280, 45, 75, 0.15, 0, Math.PI * 2);
            demoCtx.fill();

            // Front hairline - natural and fuller
            demoCtx.beginPath();
            demoCtx.moveTo(230, 235);
            demoCtx.quadraticCurveTo(265, 250, 300, 252);
            demoCtx.quadraticCurveTo(335, 250, 370, 235);
            demoCtx.quadraticCurveTo(340, 218, 300, 215);
            demoCtx.quadraticCurveTo(260, 218, 230, 235);
            demoCtx.fill();

            // Add some hair texture/strands for realism
            demoCtx.strokeStyle = '#3a2820';
            demoCtx.lineWidth = 2;
            demoCtx.lineCap = 'round';
            // Left side strands
            for (let i = 0; i < 3; i++) {
                demoCtx.beginPath();
                demoCtx.moveTo(235 + i * 15, 240);
                demoCtx.quadraticCurveTo(245 + i * 15, 260, 240 + i * 15, 280);
                demoCtx.stroke();
            }
            // Right side strands
            for (let i = 0; i < 3; i++) {
                demoCtx.beginPath();
                demoCtx.moveTo(325 + i * 15, 240);
                demoCtx.quadraticCurveTo(335 + i * 15, 260, 340 + i * 15, 280);
                demoCtx.stroke();
            }

            // Face shading for depth (prevents mask look)
            demoCtx.fillStyle = 'rgba(0, 0, 0, 0.03)';
            // Left side of face
            demoCtx.beginPath();
            demoCtx.ellipse(210, 350, 40, 100, -0.2, 0, Math.PI * 2);
            demoCtx.fill();
            // Right side of face
            demoCtx.beginPath();
            demoCtx.ellipse(390, 350, 40, 100, 0.2, 0, Math.PI * 2);
            demoCtx.fill();

            // Eyebrows
            demoCtx.fillStyle = '#3a2820';
            demoCtx.beginPath();
            demoCtx.ellipse(255, 300, 25, 4, -0.09, 0, Math.PI * 2);
            demoCtx.fill();
            demoCtx.beginPath();
            demoCtx.ellipse(345, 300, 25, 4, 0.09, 0, Math.PI * 2);
            demoCtx.fill();

            // Eyes (at ~55% from top for passport standard)
            demoCtx.strokeStyle = '#2a2a2a';
            demoCtx.lineWidth = 3;
            demoCtx.fillStyle = '#ffffff';
            // Left eye
            demoCtx.beginPath();
            demoCtx.ellipse(255, 335, 24, 30, 0, 0, Math.PI * 2);
            demoCtx.fill();
            demoCtx.stroke();
            // Right eye
            demoCtx.beginPath();
            demoCtx.ellipse(345, 335, 24, 30, 0, 0, Math.PI * 2);
            demoCtx.fill();
            demoCtx.stroke();

            // Iris
            const irisGradient = demoCtx.createRadialGradient(255, 340, 0, 255, 340, 16);
            irisGradient.addColorStop(0, '#4a90e2');
            irisGradient.addColorStop(1, '#2e5c8a');
            demoCtx.fillStyle = irisGradient;
            demoCtx.beginPath();
            demoCtx.arc(255, 340, 16, 0, Math.PI * 2);
            demoCtx.fill();
            const irisGradient2 = demoCtx.createRadialGradient(345, 340, 0, 345, 340, 16);
            irisGradient2.addColorStop(0, '#4a90e2');
            irisGradient2.addColorStop(1, '#2e5c8a');
            demoCtx.fillStyle = irisGradient2;
            demoCtx.beginPath();
            demoCtx.arc(345, 340, 16, 0, Math.PI * 2);
            demoCtx.fill();

            // Pupils
            demoCtx.fillStyle = '#1a1a1a';
            demoCtx.beginPath();
            demoCtx.arc(255, 340, 8, 0, Math.PI * 2);
            demoCtx.fill();
            demoCtx.beginPath();
            demoCtx.arc(345, 340, 8, 0, Math.PI * 2);
            demoCtx.fill();

            // Eye shine
            demoCtx.fillStyle = '#ffffff';
            demoCtx.beginPath();
            demoCtx.arc(250, 333, 5, 0, Math.PI * 2);
            demoCtx.fill();
            demoCtx.beginPath();
            demoCtx.arc(340, 333, 5, 0, Math.PI * 2);
            demoCtx.fill();
            demoCtx.beginPath();
            demoCtx.arc(260, 345, 3, 0, Math.PI * 2);
            demoCtx.fill();
            demoCtx.beginPath();
            demoCtx.arc(350, 345, 3, 0, Math.PI * 2);
            demoCtx.fill();

            // Nose
            demoCtx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            demoCtx.beginPath();
            demoCtx.ellipse(300, 375, 4, 2, 0, 0, Math.PI * 2);
            demoCtx.fill();
            // Nose bridge shadow
            demoCtx.strokeStyle = 'rgba(0, 0, 0, 0.08)';
            demoCtx.lineWidth = 1.5;
            demoCtx.beginPath();
            demoCtx.moveTo(300, 350);
            demoCtx.lineTo(300, 373);
            demoCtx.stroke();

            // Mouth
            demoCtx.strokeStyle = '#d4766a';
            demoCtx.lineWidth = 3;
            demoCtx.fillStyle = '#ffffff';
            demoCtx.beginPath();
            demoCtx.arc(300, 400, 24, 0, Math.PI, false);
            demoCtx.stroke();
            demoCtx.fill();
            demoCtx.beginPath();
            demoCtx.moveTo(290, 400);
            demoCtx.lineTo(310, 400);
            demoCtx.stroke();

            // Cheeks
            demoCtx.fillStyle = 'rgba(255, 182, 193, 0.4)';
            demoCtx.beginPath();
            demoCtx.ellipse(220, 385, 16, 11, 0, 0, Math.PI * 2);
            demoCtx.fill();
            demoCtx.beginPath();
            demoCtx.ellipse(380, 385, 16, 11, 0, 0, Math.PI * 2);
            demoCtx.fill();

            // Neck
            demoCtx.fillStyle = '#ffc999';
            demoCtx.beginPath();
            demoCtx.moveTo(250, 495);
            demoCtx.lineTo(250, 545);
            demoCtx.quadraticCurveTo(300, 565, 350, 545);
            demoCtx.lineTo(350, 495);
            demoCtx.closePath();
            demoCtx.fill();

            // Shoulders/Shirt - Curved and natural looking, stretched to edges
            demoCtx.fillStyle = '#4a6fa5';
            demoCtx.beginPath();
            // Left shoulder curve - starts from left edge
            demoCtx.moveTo(0, 600);
            demoCtx.quadraticCurveTo(100, 510, 250, 535);
            // Neckline
            demoCtx.lineTo(250, 550);
            demoCtx.quadraticCurveTo(300, 565, 350, 550);
            demoCtx.lineTo(350, 535);
            // Right shoulder curve - extends to right edge
            demoCtx.quadraticCurveTo(500, 510, 600, 600);
            // Complete the shape
            demoCtx.lineTo(600, 600);
            demoCtx.lineTo(0, 600);
            demoCtx.closePath();
            demoCtx.fill();

            // Collar
            demoCtx.fillStyle = '#ffffff';
            demoCtx.beginPath();
            demoCtx.moveTo(260, 550);
            demoCtx.lineTo(270, 590);
            demoCtx.lineTo(330, 590);
            demoCtx.lineTo(340, 550);
            demoCtx.closePath();
            demoCtx.fill();

            // Convert canvas to image
            const img = new Image();
            img.onload = () => {
                uploadedImage = img;
                // Don't add has-image class - keep upload area available
                createComposite();
                previewSection.classList.add('active');
                announceToScreenReader(window.translations[currentLanguage]?.srDemoLoaded || 'Demo photo loaded successfully. Your photo sheet preview is ready.');

                // Track demo usage
                trackEvent('demo_photo_used', {
                    language: currentLanguage
                });

                // Smooth scroll to preview
                setTimeout(() => {
                    previewSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
            };
            img.src = demoCanvas.toDataURL('image/png');
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && uploadedImage) {
                resetBtn.click();
            }
        });

        // Keyboard Navigation Hint (Day 8)
        // Show hint when user first uses Tab key
        let keyboardHintShown = localStorage.getItem('keyboardHintShown');
        if (!keyboardHintShown) {
            const showKeyboardHint = (e) => {
                if (e.key === 'Tab') {
                    const hint = document.getElementById('keyboardHint');
                    if (hint) {
                        // Show hint
                        hint.classList.add('is-visible');

                        // Hide after 5 seconds
                        setTimeout(() => {
                            hint.classList.remove('is-visible');
                        }, 5000);

                        // Mark as shown in localStorage
                        localStorage.setItem('keyboardHintShown', 'true');

                        // Remove this listener
                        document.removeEventListener('keydown', showKeyboardHint);
                    }
                }
            };

            document.addEventListener('keydown', showKeyboardHint);
        }

        // Initialize
        ctx.imageSmoothingEnabled = true;
        ctx.imageSmoothingQuality = 'high';
        // Photo loading from storage now handled by photoHandler module
        // See integration script at bottom of file

        // Register Service Worker for PWA support
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then((registration) => {
                        console.log('ServiceWorker registration successful:', registration.scope);

                        // Check for updates periodically
                        setInterval(() => {
                            registration.update();
                        }, 60000); // Check every minute
                    })
                    .catch((error) => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }

        // Track page view on load
        trackPageView();
    </script>

    <!-- UX Components Initialization -->
    <script type="module">
        import {
            initMobileNav,
            initWorkflowSelector,
            initEditorBanner,
            initTooltips,
            initStickyNav,
            ProgressSteps
        } from './js/components/ux-components.js';

        // Import common utilities
        import { initCommon } from './js/apps/common.js';

        // Initialize UX components
        document.addEventListener('DOMContentLoaded', async () => {
            // Inline footer loading (no module needed for file:// protocol)
            const footerContainer = document.getElementById('footer-container');
            if (footerContainer) {
                footerContainer.innerHTML = `
                    <footer class="footer" role="contentinfo">
                        <div class="footer-content">
                            <ul class="footer-links">
                                <li><a href="public/pages/privacy-policy.html" data-i18n="privacyPolicy">Privacy Policy</a></li>
                                <li><a href="public/pages/terms-of-service.html" data-i18n="termsOfService">Terms of Service</a></li>
                                <li><a href="public/pages/contact.html" data-i18n="contact">Contact Us</a></li>
                                <li><a href="public/pages/faq.html" data-i18n="faq">FAQ</a></li>
                            </ul>
                            <p class="footer-text" data-i18n="footerText">
                                All processing happens in your browser. Your photos are never uploaded to any server.
                                This tool is completely free and respects your privacy.
                            </p>
                            <p class="footer-copyright">
                                &copy; <span id="currentYear"></span> Photo Sheet Maker. <span data-i18n="allRights">All rights reserved</span>.
                            </p>
                            <p class="footer-designer">
                                Designed by Anil Kumar Thatha Venkatachalapathy
                            </p>
                        </div>
                    </footer>
                `;

                // Set current year
                const yearEl = document.getElementById('currentYear');
                if (yearEl) {
                    yearEl.textContent = new Date().getFullYear();
                }
            }

            // Load and initialize UX components if available
            if (window.location.protocol !== 'file:') {
                try {
                    const { initMobileNav, initWorkflowSelector, initEditorBanner, initTooltips, initStickyNav, ProgressSteps } = await import('./js/components/ux-components.js');
                    const { initStickyScroll } = await import('./js/components/sticky-scroll.js');

                    initMobileNav();
                    initWorkflowSelector();
                    initEditorBanner();
                    initTooltips();
                    initStickyNav();
                    initStickyScroll();

                    // Initialize progress steps
                    const progressSteps = new ProgressSteps('#progressSteps');
                    window.progressSteps = progressSteps; // Make accessible globally

                    // Update progress steps when image is uploaded
                    const originalUploadArea = document.getElementById('uploadArea');
                    if (originalUploadArea) {
                        // Hook into the existing file input change event
                        const fileInput = document.getElementById('fileInput');
                        if (fileInput) {
                            fileInput.addEventListener('change', () => {
                                // Show progress indicators when image is uploaded
                                const progressStepsEl = document.getElementById('progressSteps');
                                if (progressStepsEl && fileInput.files.length > 0) {
                                    progressStepsEl.style.display = 'flex';
                                    progressSteps.setStep(1); // Move to step 2 (Customize)
                                    progressSteps.completeStep(0); // Mark step 1 as completed
                                }
                            });
                        }
                    }

                    // Update progress when download button is clicked
                    const downloadBtn = document.getElementById('downloadBtn');
                    if (downloadBtn) {
                        downloadBtn.addEventListener('click', () => {
                            progressSteps.setStep(2); // Move to step 3 (Download)
                            progressSteps.completeStep(1); // Mark step 2 as completed
                        });
                    }
                } catch (error) {
                    console.log('UX components not available (file:// protocol), using basic functionality');
                }
            } else {
                console.log('Running on file:// protocol - UX enhancements disabled');
            }
        });
    </script>

    <!-- ================================================== -->
    <!-- Photo Handler Module Integration -->
    <!-- ================================================== -->
    <script type="module">
        import { initIndexPagePhotoUpload, handleStartOver } from './js/photo/photoHandler-index.js';

        // Photo handler instance
        let photoHandler = null;

        // Initialize photo handler when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            // Get current language for translations
            const currentLang = localStorage.getItem('preferredLanguage') || 'en';
            const trans = window.translations[currentLang] || window.translations.en;

            // Initialize photo upload with createComposite callback
            photoHandler = initIndexPagePhotoUpload(trans, (image, dataURL, metadata) => {
                console.log('Photo loaded via photoHandler:', metadata);

                // Set the uploadedImage for existing code
                uploadedImage = image;

                // Call existing createComposite function
                createComposite();

                // Enhanced Focus Management (Day 8)
                // Move focus to preview section after photo is loaded
                setTimeout(() => {
                    const previewSection = document.getElementById('previewSection');
                    if (previewSection) {
                        manageFocus(
                            '#previewSection',
                            window.translations[currentLang]?.srPreviewReady ||
                            'Your photo sheet preview is ready. Navigate through the customization options or download your sheet.'
                        );
                    }
                }, 500); // Small delay to ensure preview is rendered
            });

            console.log('Photo handler initialized for index page');
        });

        // Connect the "Start Over" button to photo handler
        const resetBtn = document.getElementById('resetBtn');
        if (resetBtn) {
            resetBtn.addEventListener('click', () => {
                console.log('Start Over clicked');

                handleStartOver(photoHandler, () => {
                    // Additional reset logic
                    uploadedImage = null;

                    // Clear canvas
                    const canvas = document.getElementById('previewCanvas');
                    const ctx = canvas?.getContext('2d');
                    if (ctx && canvas) {
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                    }

                    // Hide preview section
                    const previewSection = document.getElementById('previewSection');
                    if (previewSection) {
                        previewSection.classList.remove('active');
                    }

                    // Track reset event
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'form_reset', {
                            'event_category': 'Photo Upload',
                            'event_label': 'Start Over'
                        });
                    }

                    // Enhanced Focus Management (Day 8)
                    // Return focus to workflow selector after reset
                    setTimeout(() => {
                        const currentLang = localStorage.getItem('preferredLanguage') || 'en';
                        manageFocus(
                            '.c-workflow-selector',
                            window.translations[currentLang]?.srResetComplete ||
                            'Reset complete. You can now upload a new photo or use the demo.'
                        );
                    }, 500);

                    // Scroll back to upload area
                    const uploadArea = document.getElementById('uploadArea');
                    if (uploadArea) {
                        uploadArea.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                });
            });
        }

        // Update upload text when language changes
        // Hook into existing translatePage function
        const originalTranslatePage = window.translatePage;
        if (typeof originalTranslatePage === 'function') {
            window.translatePage = function(lang) {
                // Call original translation function
                originalTranslatePage(lang);

                // Update photo handler text
                if (photoHandler && window.translations[lang]) {
                    const trans = window.translations[lang];
                    photoHandler.updateText({
                        uploadText: trans.uploadText || 'Choose Your Photo',
                        uploadHint: trans.uploadHint || 'Click here or drag and drop your 2√ó2" photo',
                        successMessage: trans.uploadSuccess || 'Photo uploaded successfully'
                    });
                }
            };
        }

        // Make photoHandler accessible globally for debugging
        window.photoHandler = photoHandler;
    </script>
</body>
</html>
